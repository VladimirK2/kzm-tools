<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link href="data:text/css;charset=utf-8,h4%20%7B%0Acolor%3A%20blue%3B%0A%7D%0Apre%20%7B%20color%3A%20white%3B%20background%2Dcolor%3A%20DarkSlateGray%3B%20font%2Dfamily%3A%20monospace%2C%20monospace%3B%20%5Ffont%2Dfamily%3A%20%27courier%20new%27%2C%20monospace%3B%20font%2Dsize%3A%200%2E98em%3B%20border%2Dradius%3A%205px%3B%20border%3A%202px%20solid%20blue%3B%20padding%3A%205px%3B%20%7D%0Acode%20%7B%20color%3A%20white%3B%20background%2Dcolor%3A%20DarkSlateGray%3B%20font%2Dfamily%3A%20monospace%2C%20monospace%3B%20%5Ffont%2Dfamily%3A%20%27courier%20new%27%2C%20monospace%3B%20font%2Dsize%3A%200%2E98em%3B%20%7D%0A" rel="stylesheet" type="text/css" />
</head>
<body>
<h1 id="tafcj-script">TAFCJ script</h1>
<p>By V.Kazimirchik.</p>
<h2 id="preface">Preface</h2>
<p>Data management tools used in T24 (e.g. Data Library, BCON) have a certain drawback: they replace a record fully - and this puts a severe limitation to team work with data. Example: 2 developers at the same time amend a HELPTEXT.MENU record....</p>
<p>TAFCJ script allows conditional update of data records. It's called &quot;TAFCJ&quot; because it works both in TAFC and TAFJ. It's a jBC program.</p>
<h2 id="is-it-safe-assuming-t24-transactions-concat-files-update-etc">Is it safe assuming T24 transactions, concat files update etc?</h2>
<p>Yes, it uses OFS to update a record (to be exact - OFS.BULK.MANAGER). Firstly the full record image is written to $NAU file with IHLD status; then OFS with &quot;I&quot; function and zero authorisation is performed (can be other update options - leave in INAU or IHLD, for example). In case of an error IHLD record is deleted.</p>
<h2 id="how-to-run">How to run</h2>
<p>Minimum set of parameters:</p>
<ul>
<li>OFS.SOURCE ID. Should be the first.</li>
<li>-s:script_name</li>
</ul>
<p>E.g.:</p>
<pre><code>tafcj PW.MODEL -s:qwerty.tcj</code></pre>
<p>This command will run a script qwerty.tcj in bnk.run. If a script from other folder is required, both forward and backward slashes can be used:</p>
<pre><code>tafcj PW.MODEL -s:..\qwerty.tcj
tafcj PW.MODEL -s:../qwerty.tcj</code></pre>
<p>&quot;Minus&quot; (-) can be used instead of OFS.SOURCE ID if there;s no need to amend data (e.g.for reports).</p>
<p>If the script interpreter is run without parameters - the full list of them is being output. See chapter <a href="#parameters">parameters</a>.</p>
<h2 id="script-elements">Script elements</h2>
<h3 id="comments">Comments</h3>
<p>A line starting with '#' is a comment.</p>
<h3 id="registers-or-macros">Registers (or macros)</h3>
<p>Enclosed into dollar symbols. Similar to variables but can be used anywhere (except commands and labels):</p>
<pre><code>move
    abc
    const
        Hello
alert
    $abc$ World!
    $abc$$abc$$abc$
# output:
# Hello World!
# HelloHelloHello</code></pre>
<p>Uppercase macros can't be reassigned (useful for constants to avoid accidental change). There are also &quot;system&quot; (standard) macros that are assigned automatically: <a href="#stdmacros">Standard macros</a>.</p>
<p>Example:</p>
<pre><code>alert
    $TODAY$</code></pre>
<p>See also: <a href="#move">move</a>, <a href="#alert">alert</a></p>
<h3 id="labels">Labels</h3>
<p>Labels start with a colon.</p>
<pre><code># next line is a label
:START</code></pre>
<p>Labels are case-sensitive. They can be addressed via a macro (but can't contain a macro themselves):</p>
<pre><code>read
    F.SPF
    SYSTEM
move
    t24rel
    field
    CURRENT.RELEASE
jump
    :proc$t24rel$
:procR19
alert
    Older release
jump
    :fini
:procR23
alert
    Newer release
:fini</code></pre>
<p>See also: <a href="#move">move</a>, <a href="#jump">jump</a></p>
<h3 id="other-notes">Other notes</h3>
<p>Empty lines are ignored.</p>
<p>Non-ASCII (or extended-ASCII) characters result in fatal error (ASCII 32 to 126 are allowed only). If non-allowed characters are necessary in the data or screen output, function CHAR(nnn) has to be applied. Tab (ASCII 9) gives a warning.</p>
<h3 id="commands-in-the-order-that-allows-better-learning-process">Commands (in the order that allows better learning process)</h3>
<p>Commands are case-sensitive. Each command should occupy one line; command options follow on next line(s) with left offset at least 1 space or tab.</p>
<p>All examples contain the data from Temenos Model Bank R23 running on Windows Server 2019.</p>
<p>Alphabetical index: <a href="#alert">alert</a> | <a href="#clear">clear</a> | <a href="#clone">clone</a> | <a href="#commit">commit</a> | <a href="#company">company</a> | <a href="#debug">debug</a> | <a href="#default">default</a> | <a href="#delete">delete</a> | <a href="#exec">exec</a> | <a href="#exit">exit</a> | <a href="#getlist">getlist</a> | <a href="#getnext">getnext</a> | <a href="#jump">jump</a> | <a href="#move">move</a> | <a href="#out">out</a> / <a href="#outfile">outfile</a> | <a href="#precision">precision</a> | <a href="#read">read</a> | <a href="#runofs">runofs</a> | <a href="#select">select</a> | <a href="#sleep">sleep</a> | <a href="#update">update</a></p>
<h4 id="alert">alert</h4>
<p>Output a message to the screen. Message will appear immediately and also in the final report.</p>
<pre><code>alert
    All is done</code></pre>
<p><em>All alerts are repeated in &quot;final report&quot; (together with [INFO] prefix) in order not to be missed during execution - especially if there was output of T24 transaction processing that often resets the screen.</em></p>
<p>Several alerts can be issued at once, e.g.:</p>
<pre><code>alert
    Working...
    All is done</code></pre>
<p>jBASE delimiters are masked in alert output, e.g.: (<span class="citation">@FM</span>) etc.</p>
<h4 id="exit">exit</h4>
<p>Finish the work. Return 0 by default or - if specified - a numeric error code. Error codes 1 - 999 are reserved for the script interpreter. Code 1000 can be used to suppress the output of the final report.</p>
<pre><code># exit with the error.
exit
    1001</code></pre>
<p>The return code presents in the screen output:</p>
<pre><code>[ERROR] Non-zero exit code detected
Exit code: 1001
Script line: 3
Elapsed time: 0.01 s.</code></pre>
<p>Return codes provided by the interprerer: <a href="#retcodes">Return codes</a>.</p>
<h4 id="exec">exec</h4>
<p>Proceed with jBC statement EXECUTE.</p>
<p>Create a table:</p>
<pre><code>exec
    CREATE-FILE F.TEST TYPE=MSSQL</code></pre>
<p>Output:</p>
<pre><code>[INFO] Command at the line 2: return code &quot;&quot;
[INFO] Finished successfully</code></pre>
<p>Second run:</p>
<pre><code>[INFO] Command at the line 2: return code &quot;413]There is already an object named 'D_F_TEST' in the database.&quot;
[INFO] Finished successfully</code></pre>
<p><em>Successful finish happened because the option to check the return code wasn't activated (see below)</em>.</p>
<p>Copy a record:</p>
<pre><code>exec
    COPY FROM F.SPF TO F.TEST ALL</code></pre>
<p>Output:</p>
<pre><code>[INFO] Command at the line 2: return code &quot;805]1]COPY_DONE&quot;
[INFO] Finished successfully</code></pre>
<p>Check return code, script will fail if it doesn't match:</p>
<pre><code>exec
    COPY FROM F.SPF TO F.TEST ALL
    805$VM$1$VM$COPY_DONE</code></pre>
<p>Output:</p>
<pre><code>[ERROR] Command at the line 2: return code &quot;805]0]COPY_DONE&quot;, expected : &quot;805]1]COPY_DONE&quot;
Exit code: 56
Script line: 3</code></pre>
<p>Correct the copy command:</p>
<pre><code>exec
    COPY FROM F.SPF TO F.TEST ALL OVERWRITING
    805$VM$1$VM$COPY_DONE</code></pre>
<p>Output:</p>
<pre><code>[INFO] Command at the line 2: return code &quot;805]1]COPY_DONE&quot; (as expected)
[INFO] Finished successfully</code></pre>
<p>System macros $EXECSCREEN$, $EXECRETCODE$, $EXECRETDATA$ and $EXECRETLIST$ are available after exec command:</p>
<pre><code>exec
    COPY FROM F.SPF TO F.TEST ALL OVERWRITING
alert
    $EXECSCREEN$
    $EXECRETCODE$</code></pre>
<p>Output:</p>
<pre><code>[INFO] Command at the line 2: return code &quot;805]1]COPY_DONE&quot;
[INFO] 1 records copied
[INFO] 805 (@VM) 1 (@VM) COPY_DONE</code></pre>
<h4 id="read">read</h4>
<p>Read a record into record buffer. Examples:</p>
<pre><code>read
    F.SPF
    SYSTEM

read
    F.COMPANY
    GB0010001</code></pre>
<p>A non-existing record can be specified for further population and update.</p>
<p>After read command system macros $RECORD$, $DICT$ and $LREF$ are available:</p>
<pre><code>read
    F.ABBREVIATION
    FT
alert
    $RECORD$
    $DICT$
read
    FBNK.AA.ARRANGEMENT.ACTIVITY
    DUMMY
alert
    $LREF$</code></pre>
<p>Output:</p>
<pre><code>[INFO] FUNDS.TRANSFER (@FM)  (@FM) 1 (@FM) 1_R14m (@FM) 2305230233 (@FM) 7_TRAIN511_OFS_MB.OFS (@FM) GB0010001 (@FM) 1
[INFO] ORIGINAL.TEXT (@FM) RECORD.STATUS (@FM) CURR.NO (@FM) INPUTTER (@FM) DATE.TIME (@FM) AUTHORISER (@FM) CO.CODE (@FM) DEPT.CODE (@FM) AUDITOR.CODE ...
[INFO] USRETL.ITEM.TYP (@FM) USRETL.ITEM.VAL (@FM) IS.CONTRACT.REF (@FM) IS.PRODUCT (@FM) IS.COM.SALE.REF (@FM) IS.DISBURSE.REF (@FM) REQUEST.CUST (@FM) HUWRNT.TXN.CODE</code></pre>
<p>To see if a record is a new or existing one the system macro $NEWRECORD$ can be used:</p>
<pre><code>read
    F.HELPTEXT.MENU
    NEW
jump
    :newrec$NEWRECORD$
:newrec0
alert
    Record exists
exit
:newrec1
alert
    Record is new</code></pre>
<h4 id="update">update</h4>
<p>Update a field in the record being read into buffer. Syntax is OFS-like.</p>
<pre><code>read
    F.ABBREVIATION
    QWERTY
update
    ORIGINAL.TEXT::=TEST TWO

# make field empty
read
    F.USER
    VKAZIMIRCHIK
update
    INIT.APPLICATION::=

# assign MV field
read
    FBNK.CUSTOMER
    100500
update
    OTHER.OFFICER:1:=1
    OTHER.OFFICER:2:=100

# add a new value to MV field
read
    FBNK.CUSTOMER
    100100
update
    OTHER.OFFICER:-1:=104

# SV field
read
    F.PRINTER.ID
    TEST
update
    COMMAND:1:1=TEST1
    COMMAND:1:2=TEST2

# add associated fields
read
    F.HELPTEXT.MENU
    MY.MENU
update
    APPLICATION:-1:1=SC.SETTLEMENT,ACT.SETT I E
    DESCRIPT:-1:1=Unauth Actual Settlement</code></pre>
<h5 id="note">Note</h5>
<p><em>Be careful in adding associations - all associated fields must be mentioned, even no-input and empty ones.</em></p>
<h4 id="commit">commit</h4>
<p>Commit changes to a record - data from buffer is posted to the database. As it was noted before, OFS is used to process the written IHLD record.</p>
<pre><code># commit
commit

# use a specific VERSION
commit
    ,AMEND

# leave record in INAU
commit
    INAU

# leave record in IHLD status
commit
    IHLD

# raw commit, not recommended unless there's no other way
commit
    RAW</code></pre>
<h5 id="notes">Notes</h5>
<p><em>It's not possible to commit (all modes except &quot;RAW&quot;) if a NAU record already exists - in order not to lose the last changes</em>.</p>
<p><em>If the record wasn't changed, it will not be processed and a warning message will appear: &quot;LIVE RECORD NOT CHANGED&quot;.</em></p>
<p><em>If the record was changed and no commit was done at the script end or before another &quot;read&quot;, fatal error is triggered: &quot;Changes not saved&quot;</em>.</p>
<p><em>If &quot;committing&quot; OFS fails, temporary IHLD record is deleted. Unfortunately, under TAFJ it doesn't happen because the whole session aborts.</em></p>
<h4 id="clear">clear</h4>
<p>Clear the whole record (keeping audit trail).</p>
<pre><code>read
    F.VERSION
    FUNDS.TRANSFER,TCIB
clear
update
    RECORDS.PER.PAGE::=1
    FIELDS.PER.LINE::=1
    NO.OF.AUTH::=2
commit</code></pre>
<h4 id="clone">clone</h4>
<p>Clone another record into existing one (except audit trail).</p>
<pre><code>read
    F.OFS.SOURCE
    TEST
clone
    F.OFS.SOURCE
    PW.MODEL
update
    GENERIC.USER::=AUTHORISER
commit</code></pre>
<h4 id="delete">delete</h4>
<p>Delete a record. Sometimes deleting of a record via OFS is impossible (usually due to core errors when it applies some checks not intended for D function). Use with care!</p>
<pre><code>delete
    FBNK.CUSTOMER$NAU
    100100</code></pre>
<p>Output:</p>
<pre><code>[INFO] Record FBNK.CUSTOMER$NAU&gt;100100 deleted</code></pre>
<p>Or:</p>
<pre><code>[WARN] Record FBNK.CUSTOMER$NAU&gt;100100 does not exist, unable to delete</code></pre>
<h5 id="note-1">Note</h5>
<p><em>Of course &quot;exec&quot; command could be used for it but there were certain problems with that approach under TAFJ.</em></p>
<h4 id="jump">jump</h4>
<p>Non-conditional jump to a label.</p>
<pre><code># do something 5 times
move
    cntr
    const
        0
:strt
move
    cntr
    func
        ADDS($cntr$, 1)
    01
    func
        LE($cntr$, 5)
jump
    :proc$01$
:proc1
alert
    $cntr$
jump
    :strt
:proc0
# finish</code></pre>
<p>See also: <a href="#move">move</a>.</p>
<h4 id="select">select</h4>
<p>Proceed with jQL SELECT</p>
<pre><code>select
# name of the resulting SELECT list
    LOCKING_SEL
# SELECT statement
    F.LOCKING WITH @ID LIKE FBNK...
    SAMPLE 5
getlist
    LOCKING_SEL
:strt
getnext
    LOCKING_SEL
    next_id
alert
    $next_id$
jump
    :strt
# special label where we go when SELECT list is exhausted
:no_more_LOCKING_SEL
exit 0</code></pre>
<h4 id="getlist">getlist</h4>
<p>Get saved list. See <a href="#select">select</a>.</p>
<h4 id="getnext">getnext</h4>
<p>Get the next item in saved list. See <a href="#select">select</a>.</p>
<h4 id="move">move</h4>
<p>Assign a macro.</p>
<p>Keywords:</p>
<h5 id="const">const</h5>
<p>A constant:</p>
<pre><code>move
    zero
    const
        0
# create a dynamic array
    array
    const
        A$FM$BB$VM$CCC$SM$$zero$
alert
    $array$</code></pre>
<p>Output:</p>
<pre><code>A (@FM) BB (@VM) CCC (@SM) 0</code></pre>
<p>See also: <a href="#stdmacros">Standard macros</a>.</p>
<h5 id="field">field</h5>
<pre><code>read
    FBNK.CUSTOMER
    100100
move
    tc
    field
        TOWN.COUNTRY
    mname
    field
        PRIVACY.STATUS
alert
    $tc$, $mname$</code></pre>
<p>Output: Seattle, OPT-IN</p>
<h5 id="func">func</h5>
<p>A function. Supported functions list: ABS, ABSS, ADDS, ALPHA, ANDS, BYTELEN, CATS, CHANGE, CHANGETIMESTAMP, CHAR, CHARS, CONVERT, COUNT, COUNTS, DATE, DCOUNT, DIR, DIV, DIVS, DOWNCASE, DQUOTE, DROUND, DTX, EQS, EREPLACE, EXTRACT, FADD, FDIV, FIELD, FIELDS, FILEINFO (key = 1 only), FMT, FMTS, FMUL, FOLD, FSUB, GES, GETCWD, GETENV, ICONV, ICONVS, IFS, INDEX, INPUT, INT, ISALNUM, ISALPHA, ISCNTRL, ISDIGIT, ISLOWER, ISPRINT, ISSPACE, ISUPPER, LEFT, LEN, LENS, LES, LOCALDATE, LOCALTIME, LOWER, MAKETIMESTAMP, MATCHFIELD, MAXIMUM, MINIMUM, MOD, MODS, MULS, NEG, NEGS, NES, NOT, NOTS, NUM, NUMS, OCONV, OCONVS, ORS, PUTENV, PWR, RAISE, REGEXP, REPLACE, RIGHT, RND, SADD, SDIV, SENTENCE, SEQ, SEQS (emulation), SMUL, SORT, SPACE, SPACES, SPLICE, SQRT, SQUOTE, SSUB, STR, STRS, SUBS, SUBSTRINGS, SUM, SYSTEM, TIME, TIMEDATE, TIMEDIFF, TIMESTAMP, TRANS, TRIM, UNIQUEKEY, UPCASE, XTD.</p>
<p>Pseudo-functions EQ(), NE(), LT(), LE(), GT(), GE(), DEL(), INS(), FIND(), FINDSTR() and MATCHES() use corresponding operators and statements to proceed their &quot;parameters&quot;.</p>
<p>Examples:</p>
<pre><code>read
    F.SPF
    SYSTEM
move
    prods
    field
        PRODUCTS
    qty
    func
        DCOUNT($prods$, $VM$)
alert
    $qty$</code></pre>
<p>Output: 627.</p>
<p>Notes:</p>
<p><em>Function parameters are to be specified without quotes, comma-delimited</em>.</p>
<p><em>Only one set of parentheses can be used in function definition. If those are necessary in function parameters, system macros $LPARENTH$ amd $RPARENTH$ are to be used</em>.</p>
<p><em>Commas in function parameters shall be represented as $COMMA$</em>.</p>
<p><em>Spaces in function definition are removed during parsing. If space is a part of function parameter - system macro $SPACE$ is to be used</em>.</p>
<pre><code>move
    output
    func
        MATCHES( FT220172HQJ4, 'F'1A5N5X )
alert
    Result: $output$</code></pre>
<p>Output:</p>
<pre><code>Result: 1</code></pre>
<p>More examples:</p>
<pre><code>read
    FBNK.ACCOUNT
    DUMMY
move
    finfo
    func
        FILEINFO()
    ftype
    func
        EXTRACT( $finfo$, 21 )
alert
    $ftype$
# output: XMLMSSQL

move
    outp
    func
        CONVERT(CEYZ, +-*$COMMA$, ABCCCDEFCDYZ)
alert
    $outp$
# output: AB+++D-F+D*,</code></pre>
<p>In this example conditional TAFC/TAFJ script lines are shown:</p>
<pre><code>move
    func_name
    const
    GETENV
alert
    Testing $func_name$() ...
move
    rezt
    func
=TAFC    $func_name$( TAFC_HOME )
=TAFJ    $func_name$( TAFJ_HOME )
alert
    $rezt$</code></pre>
<p>Output (TAFC):</p>
<pre><code>C:\temenos\TAFC\R23</code></pre>
<p>Output (TAFJ):</p>
<pre><code>C:\temenos\TAFJ</code></pre>
<h5 id="subr">subr</h5>
<p>Call a &quot;EVAL&quot; subroutine - one that can be used in jQL EVAL(). Example:</p>
<p>jBC subroutine:</p>
<pre><code>SUBROUTINE tafCJlocref(out_lref_list, in_app_name)
*
    CALL EB.LOCREF.SETUP(in_app_name, out_lref_list)
*
    RETURN
END</code></pre>
<p>Script:</p>
<pre><code>move
    lrefs
    subr
        tafCJlocref ACCOUNT
    fld1
    func
        EXTRACT($lrefs$, 1, 1)
    fld2
    func
        EXTRACT($lrefs$, 2, 1)
    fld3
    func
        EXTRACT($lrefs$, 3, 1)
    qty
    func
        DCOUNT($lrefs$, $FM$)
alert
    $fld1$
    $fld2$
    $fld3$
    Local fields found: $qty$
# output:
# PLEDGE.PURPOSE
# PLEDGE.FLAG
# SOLD.DATE
# Local fields found: 138</code></pre>
<h4 id="default">default</h4>
<p>Default a macro passed via &quot;-var:&quot; parameter.</p>
<p>Script test.tcj:</p>
<pre><code>exec
    DOS /c C:\temenos\TAFJ\bin\trun.bat tafcj - -s:\temenos\TAFJ\UD\test2.tcj -var:folder:ETC.BP
move
    out1
    func
        CHANGE( $EXECSCREEN$, $FM$, $LF$ )
exec
    DOS /c C:\temenos\TAFJ\bin\trun.bat tafcj - -s:\temenos\TAFJ\UD\test2.tcj
move
    out2
    func
        CHANGE( $EXECSCREEN$, $FM$, $LF$ )
alert
    $out1$
    $out2$
exit
    1000</code></pre>
<p>Script test2.tcj:</p>
<pre><code>default
    folder
    const
        MISC.BP
alert
    Will proceed $folder$
exit
    1000</code></pre>
<p>Output:</p>
<pre><code>Will proceed ETC.BP
Will proceed MISC.BP</code></pre>
<p>See chapter <a href="#parameters">parameters</a>.</p>
<h4 id="runofs">runofs</h4>
<p>Execute OFS message.</p>
<pre><code>move
    abbr_id
    const
        TEST.FTNAU
runofs
    ABBREVIATION,/I/PROCESS//0,$USERNAME$/$PASSWORD$,$abbr_id$,ORIGINAL.TEXT::=FUNDS.TRANSFER? E
alert
    $OFSCOMMIT$
    $OFSOUTPUT$</code></pre>
<p>Result:</p>
<pre><code>1
TEST.FTNAU/PWOFS233406951652333.01/1,ORIGINAL.TEXT:1:1=FUNDS.TRANSFER, E,CURR.NO:1:1=1,INPUTTER:1:1=69516_AUTHORISER__OFS_PW.MODEL,DATE.TIME:1:1=2312061432,
AUTHORISER:1:1=69516_AUTHORISER_OFS_PW.MODEL,CO.CODE:1:1=GB0010001,DEPT.CODE:1:1=1</code></pre>
<h4 id="sleep">sleep</h4>
<pre><code>move
    tdate
    func
        TIMEDATE()
alert
    $tdate$
    Going to sleep 5 seconds
sleep
    5
move
    tdate
    func
        TIMEDATE()
alert
    $tdate$</code></pre>
<p>Output:</p>
<pre><code>20:06:51 06 DEC 2023
Going to sleep 5 seconds
20:06:56 06 DEC 2023</code></pre>
<h4 id="out">out</h4>
<h4 id="outfile">outfile</h4>
<p>Output information to a text file.</p>
<pre><code>outfile
# number of file
    1
#folder
    TAFJAY.OUT
# file
    tcjtest-1.txt
# next file
    2
    TAFJAY.OUT
    tcjtest-2.txt
move
    tdate_ini
    func
        TIMEDATE()
sleep
    5
move
    tdate
    func
        TIMEDATE()
out
    1
    $tdate_ini$
out
    2
    $tdate_ini$
    $tdate$</code></pre>
<h4 id="precision">precision</h4>
<p>Invoke PRECISION statement.</p>
<pre><code>precision
    13
move
    rezt
    func
        DIVS(1, 3)
alert
    $rezt$
precision
    3
move
    rezt
    func
        DIVS(1, 3)
alert
    $rezt$</code></pre>
<p>Output:</p>
<pre><code>0.3333333333333
0.333</code></pre>
<h4 id="company">company</h4>
<p>Change a current COMPANY. Necessary if a commit will be used. If not, data can be read without this command.</p>
<pre><code>company
    AU0010001
read
    FAU1.INDUSTRY
    123
move
    descr
    field
        DESCRIPTION
move
    descr
    const
        $descr$!
update
    DESCRIPTION::=$descr$
commit</code></pre>
<h4 id="debug">debug</h4>
<p>Enter the debugger.</p>
<h2 id="parameters">parameters</h2>
<pre><code>-------------------------------------------------------------
&lt;OFS.SOURCE ID&gt;   | @ID of OFS.SOURCE to use
                  |   - this parameter is mandatory
                  |   - its type should be &quot;TELNET&quot;
                  |   - has to be the first one
                  | Can be replaced by - (if no commits used)
-------------------------------------------------------------
All following parameters can be specified in any order:
-------------------------------------------------------------
-s:&lt;script&gt;       | script to process (with path)
                  |   - this parameter is mandatory
                  |   - can be specified as:
                  |     path/file
                  |     path\file
-------------------------------------------------------------
The following parameters are not mandatory:
-------------------------------------------------------------
-l:&lt;login&gt;        | T24 login
-------------------------------------------------------------
-p:&lt;password&gt;     | T24 password
-------------------------------------------------------------
-var              | free-format parameter to supply a
                  | register value, e.g.:
                  | -var:date:20170630 (mask spaces with #20)
                  | -var:equ:A#3dB (mask &quot;=&quot; with #3d)
                  | -var:rec:SPF#3eSYSTEM (mask &quot;&gt;&quot; with #3e)
-------------------------------------------------------------</code></pre>
<h2 id="retcodes">retcodes</h2>
<p>Return codes supported by the interprerer:</p>
<ul>
<li>0 success</li>
<li>1 unknown error</li>
<li>2 Parameters missing</li>
<li>3 Error opening OFS.SOURCE</li>
<li>4 OFS.SOURCE <span class="citation">@ID</span> not found</li>
<li>5 non-TELNET OFS.SOURCE</li>
<li>6 Unrecognized parameter</li>
<li>7 Script file not specified</li>
<li>8 Script file - open error</li>
<li>9 Script file - read error</li>
<li>10 Script file - non-ASCII characters found</li>
<li>11 Script file size exceeds maximum</li>
<li>12 Error opening SPF</li>
<li>13 Error opening table on read/delete command</li>
<li>14 Error opening F.MNEMONIC.COMPANY</li>
<li>15 Error reading F.MNEMONIC.COMPANY</li>
<li>16 Changes not saved</li>
<li>17 Command not recognized</li>
<li>18 Command not finished properly</li>
<li>19 Duplicate label</li>
<li>20 Label not found</li>
<li>21 Non-numeric exit code</li>
<li>22 Non-zero exit codes less than 1000 are reserved for script interpreter</li>
<li>23 Field not found</li>
<li>24 Forbidden to specify LOCAL.REF, use local field name</li>
<li>25 LOCAL.REF not found in DICT</li>
<li>26 <span class="citation">@VM</span> number is not numeric</li>
<li>27 <span class="citation">@SM</span> number is not numeric</li>
<li>28 <span class="citation">@SM</span> number requires <span class="citation">@VM</span> number to be set explicitly</li>
<li>29 Subvalue for LOCAL.REF is set up in <span class="citation">@VM</span> place</li>
<li>30 Error parsing update command</li>
<li>31 VERSION or commit mode expected</li>
<li>32 VERSION expected</li>
<li>33 Commit mode expected</li>
<li>34 No updates specified</li>
<li>35 Unable to open $NAU file</li>
<li>36 $NAU record exists, unable to continue</li>
<li>37 Unable to write to $NAU file</li>
<li>38 Unable to delete a record</li>
<li>39 OFS error</li>
<li>40 OFS.SOURCE is mandatory for this operation</li>
<li>41 SELECT error</li>
<li>42 SELECT list does not exist</li>
<li>43 Command &quot;move&quot;: keyword is not supported</li>
<li>44 No &quot;read&quot; command was executed yet</li>
<li>45 One or both parentheses missing in function definition</li>
<li>46 Only one set of parentheses allowed function definition</li>
<li>47 Function not found in the list of functions with N parameter(s)</li>
<li>48 Uppercase macro can not be reassigned</li>
<li>49 Error opening F.USER.SIGN.ON.NAME</li>
<li>50 Not valid T24 login name</li>
<li>51 Unable to write to LIVE file</li>
<li>52 Cancelled by user</li>
<li>53 Forbidden to redefine internal registers</li>
<li>54 Wrong syntax</li>
<li>55 Non-numeric PRECISION detected</li>
<li>56 exec - return code not as expected</li>
<li>57 File already used for output</li>
<li>58 Unable to create file for output</li>
<li>59 Area number N already used for output</li>
<li>60 No file for area number N opened for output</li>
<li>61 Error writing to output file for area number N</li>
<li>62 Unable to clone from non-existing record</li>
</ul>
<h2 id="stdmacros">stdmacros</h2>
<ul>
<li>$TODAY$</li>
<li>$LCCY$</li>
<li>$ID.COMPANY$</li>
<li>$FM$</li>
<li>$VM$</li>
<li>$SM$</li>
<li>$TM$</li>
<li>$SPACE$</li>
<li>$BLANK$</li>
<li>$RECORD$</li>
<li>$EXECSCREEN$</li>
<li>$EXECRETCODE$</li>
<li>$EXECRETDATA$</li>
<li>$EXECRETLIST$</li>
<li>$LF$</li>
<li>$TAB$</li>
<li>$DIR_DELIM_CH$</li>
<li>$COMMA$</li>
<li>$LPARENTH$</li>
<li>$RPARENTH$</li>
<li>$USERNAME$</li>
<li>$PASSWORD$</li>
<li>$OFSCOMMIT$</li>
<li>$OFSOUTPUT$</li>
<li>$DICT$</li>
<li>$LREF$</li>
<li>$NEWRECORD$</li>
</ul>
</body>
</html>
